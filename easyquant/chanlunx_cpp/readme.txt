copy from ChanlunX
https://github.com/shenqisoft/ChanlunX